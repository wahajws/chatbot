{
	"info": {
		"_postman_id": "chatbot-api-collection",
		"name": "Chatbot API",
		"description": "Collection for testing the Chatbot API with PostgreSQL and Alibaba LLM integration",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Root",
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/",
					"host": [
						"{{base_url}}"
					],
					"path": [
						""
					]
				},
				"description": "Get API information and available endpoints"
			},
			"response": []
		},
		{
			"name": "Chat",
			"item": [
				{
					"name": "Send Message",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has success field\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"    pm.expect(jsonData.success).to.eql(true);",
									"});",
									"",
									"pm.test(\"Response contains message and response\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData).to.have.property('response');",
									"    pm.expect(jsonData).to.have.property('id');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"message\": \"Hello, what is artificial intelligence?\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/chat",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"chat"
							]
						},
						"description": "Send a message to the chatbot and get an AI response. The message will be saved to the database."
					},
					"response": []
				},
				{
					"name": "Send Message with Conversation Context",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"message\": \"Can you tell me more about that?\",\n    \"conversationId\": 1\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/chat",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"chat"
							]
						},
						"description": "Send a message with conversation context. The conversationId references a previous message ID to include conversation history."
					},
					"response": []
				},
				{
					"name": "Send Message - Empty Message (Error)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 400\", function () {",
									"    pm.response.to.have.status(400);",
									"});",
									"",
									"pm.test(\"Response has error field\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('error');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"message\": \"\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/chat",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"chat"
							]
						},
						"description": "Test error handling for empty message"
					},
					"response": []
				},
				{
					"name": "Get Chat History",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has messages array\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"    pm.expect(jsonData).to.have.property('messages');",
									"    pm.expect(jsonData.messages).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/chat/history?limit=20&offset=0",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"chat",
								"history"
							],
							"query": [
								{
									"key": "limit",
									"value": "20",
									"description": "Number of messages to return"
								},
								{
									"key": "offset",
									"value": "0",
									"description": "Number of messages to skip"
								}
							]
						},
						"description": "Get chat history with pagination support"
					},
					"response": []
				},
				{
					"name": "Get Chat History - Limited",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/chat/history?limit=5",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"chat",
								"history"
							],
							"query": [
								{
									"key": "limit",
									"value": "5"
								}
							]
						},
						"description": "Get only the last 5 messages"
					},
					"response": []
				},
				{
					"name": "Get Message by ID",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has message object\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"    pm.expect(jsonData).to.have.property('message');",
									"    pm.expect(jsonData.message).to.have.property('id');",
									"    pm.expect(jsonData.message).to.have.property('message');",
									"    pm.expect(jsonData.message).to.have.property('response');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/chat/1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"chat",
								"1"
							]
						},
						"description": "Get a specific message by its ID. Replace '1' with the actual message ID."
					},
					"response": []
				},
				{
					"name": "Get Message by ID - Not Found",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 404\", function () {",
									"    pm.response.to.have.status(404);",
									"});",
									"",
									"pm.test(\"Response has error field\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('error');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/chat/99999",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"chat",
								"99999"
							]
						},
						"description": "Test error handling for non-existent message ID"
					},
					"response": []
				}
			],
			"description": "Endpoints for chat functionality"
		},
		{
			"name": "Knowledge Base",
			"item": [
				{
					"name": "Add Knowledge Entry",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has entry\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"    pm.expect(jsonData).to.have.property('entry');",
									"    pm.expect(jsonData.entry).to.have.property('id');",
									"    pm.expect(jsonData.entry).to.have.property('content');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"title\": \"About This Database\",\n    \"content\": \"This is a chatbot database that stores conversation history and knowledge base entries. It uses PostgreSQL with pgvector extension for vector similarity search capabilities. The database contains information about various topics that can be queried by the chatbot.\",\n    \"category\": \"Database\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/knowledge",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"knowledge"
							]
						},
						"description": "Add a new entry to the knowledge base. This information will be used by the chatbot to answer questions."
					},
					"response": []
				},
				{
					"name": "Get All Knowledge Entries",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has entries array\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"    pm.expect(jsonData).to.have.property('entries');",
									"    pm.expect(jsonData.entries).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/knowledge?limit=50&offset=0",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"knowledge"
							],
							"query": [
								{
									"key": "limit",
									"value": "50",
									"description": "Number of entries to return"
								},
								{
									"key": "offset",
									"value": "0",
									"description": "Number of entries to skip"
								}
							]
						},
						"description": "Get all knowledge base entries with pagination"
					},
					"response": []
				},
				{
					"name": "Search Knowledge Base",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test(\"Response has results\", function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData).to.have.property('success');",
									"    pm.expect(jsonData).to.have.property('results');",
									"    pm.expect(jsonData.results).to.be.an('array');",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/api/knowledge/search?q=database&limit=5",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"knowledge",
								"search"
							],
							"query": [
								{
									"key": "q",
									"value": "database",
									"description": "Search query"
								},
								{
									"key": "limit",
									"value": "5",
									"description": "Maximum number of results"
								}
							]
						},
						"description": "Search the knowledge base for relevant information"
					},
					"response": []
				}
			],
			"description": "Endpoints for managing the knowledge base"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:3000",
			"type": "string"
		}
	]
}


